(this["webpackJsonpweather-widget"]=this["webpackJsonpweather-widget"]||[]).push([[0],{374:function(e,t,c){},375:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c(31),s=c.n(r),a=c(21),i=c(391),j=c(389),o=c(179),d=c(378),u=c(23),b=c(38),l=c.n(b),O=c(103),h="SEARCH_CITY_REQ_START",f="SEARCH_CITY_REQ_SUCCESS",x="SEARCH_CITY_REQ_ERROR",y="ADD_TO_FAVORITE",p="REMOVE_FROM_FAVORITE",m=function(e){return{type:y,payload:{city:e}}},g=function(e){return{type:p,payload:{city:e}}},v="GET_DEFAULT_CITY_COORDS_REQ_START",C="GET_DEFAULT_CITY_COORDS_REQ_SUCCESS",R="GET_DEFAULT_CITY_COORDS_REQ_ERROR",w="FORECAST_FIVEDAYS_REQ_START",_="FORECAST_FIVEDAYS_REQ_SUCCESS",E="FORECAST_FIVEDAYS_REQ_ERROR",S=c(175),T=c(176),k=c.n(T),I=new function e(){Object(S.a)(this,e),this.myValue="3476f426c6d8f97027e143c1f5b3b21e",this.serverApi="https://api.openweathermap.org/data/2.5",this.client=k.a.create({baseURL:this.serverApi,params:{APPID:this.myValue}})},F=c(2),A=Object(n.memo)((function(){var e=Object(n.useState)(""),t=Object(a.a)(e,2),c=t[0],r=t[1],s=Object(u.b)(),b=Object(n.useCallback)((function(e){return r(e.target.value)}),[]),y=Object(n.useCallback)((function(e){var t;e.preventDefault(),s((t=c,function(){var e=Object(O.a)(l.a.mark((function e(c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({type:h}),e.next=3,I.client.get("/weather?q=".concat(t)).then((function(e){var t=e.data;c({type:f,payload:{searchedCity:t}})})).catch((function(e){var t=e.message;return c({type:x,payload:{error:t}})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),r("")}),[s,c]);return Object(F.jsxs)(i.a,{bg:"dark",variant:"dark",children:[Object(F.jsx)(i.a.Brand,{children:"My weather app"}),Object(F.jsxs)(j.a,{inline:!0,onSubmit:y,children:[Object(F.jsx)(o.a,{type:"text",placeholder:"Search city by name",className:"mr-sm-2",onChange:b,value:c}),Object(F.jsx)(d.a,{type:"submit",variant:"success",children:"Search"})]})]})})),D=c(387),q=c(388),P=c(392),M=c(180),N=c(380),Y=c(381),Q=c(385),V=c(197),U=c(198),L=c(82),W=c(204),H=c(379),B=c(181),G=Object(B.a)((function(e){var t,c;return null===(t=e.forecastCity)||void 0===t||null===(c=t.forecast5city)||void 0===c?void 0:c.list}),(function(e){return e.map((function(e){return{name:e.dt_txt,temp:(e.main.temp-273.15).toFixed(0)}}))})),J=Object(n.memo)((function(){var e=Object(u.c)((function(e){return e.forecastCity.forecast5city})),t=Object(u.c)((function(e){return e})),c=Object(u.c)((function(e){return e.forecastCity.isRequestInProgress})),n=G(t);return c?Object(F.jsx)(H.a,{animation:"grow"}):e?Object(F.jsxs)(M.a,{md:12,children:[Object(F.jsxs)("h2",{children:["Forecast for 5 day for city ",e.city.name]}),Object(F.jsx)(N.a,{width:"100%",aspect:2.5,height:"300px",children:Object(F.jsxs)(Y.a,{width:1500,height:300,data:n,margin:{top:5,right:30,left:20,bottom:5},children:[Object(F.jsx)(Q.a,{strokeDasharray:"3 3"}),Object(F.jsx)(V.a,{dataKey:"name"}),Object(F.jsx)(U.a,{}),Object(F.jsx)(L.a,{}),Object(F.jsx)(W.a,{type:"monotone",dataKey:"temp",stroke:"red",activeDot:{r:5}})]})})]}):null})),K=c(386),X=function(e){return"https://openweathermap.org/img/w/".concat(e,".png")},z=function(e){var t=e.getHours(),c="0"+e.getMinutes(),n="0"+e.getSeconds();return t+":"+c.substr(-2)+":"+n.substr(-2)},Z=Object(n.memo)((function(e){var t=e.city,c=e.addToFavorite,r=e.canRemove,s=Object(u.b)(),a=t.sys,i=a.country,j=a.sunrise,o=a.sunset,b=t.main,h=t.wind,f=t.coord,x=t.id,y=t.weather,p=t.name,m=Object(n.useMemo)((function(){return new Date(1e3*j)}),[j]),v=Object(n.useMemo)((function(){return new Date(1e3*o)}),[o]),C=Object(n.useMemo)((function(){return(new Date).toLocaleDateString()}),[]),R=Object(n.useMemo)((function(){return z(m)}),[m]),S=Object(n.useMemo)((function(){return z(v)}),[v]),T=Object(n.useCallback)((function(){return s(g(t))}),[s,t,g]),k=Object(n.useCallback)((function(){return c(t)}),[t,c]),A=Object(n.useCallback)((function(){return s(function(e){return function(){var t=Object(O.a)(l.a.mark((function t(c){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return c({type:w}),t.next=5,I.client.get("/forecast?id=".concat(e)).then((function(e){var t=e.data;c({type:_,payload:{forecast5city:t}})})).catch((function(e){var t=e.message;return c({type:E,payload:{error:t}})}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(x))}),[x]);return t&&Object.keys(t).length?Object(F.jsxs)("div",{className:"single",children:[Object(F.jsx)("h2",{children:p}),Object(F.jsx)("img",{src:X(y[0].icon),alt:"weather"}),Object(F.jsx)("p",{style:{textAlign:"center"},children:y[0].description}),Object(F.jsx)(K.a,{striped:!0,bordered:!0,hover:!0,children:Object(F.jsxs)("tbody",{children:[Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"t\xb0 "}),Object(F.jsxs)("td",{children:[(b.temp-273.15).toFixed(0),"\u2103"]})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Country:"}),Object(F.jsx)("td",{children:i})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Today is:"}),Object(F.jsx)("td",{children:C})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Sunrise:"}),Object(F.jsx)("td",{children:R})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Sunset:"}),Object(F.jsx)("td",{children:S})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Humidity:"}),Object(F.jsxs)("td",{children:[b.humidity,"%"]})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Wind:"}),Object(F.jsxs)("td",{children:[h.deg?Object(F.jsxs)(n.Fragment,{children:["direction:\xa0",h.deg<90?Object(F.jsx)("span",{children:"North-East"}):null,h.deg>=90&&h.deg<180?Object(F.jsx)("span",{children:"South-East"}):null,h.deg>=180&&h.deg<270?Object(F.jsx)("span",{children:"South-West"}):null,h.deg>=270&&h.deg<360?Object(F.jsx)("span",{children:"North-West"}):null,", ",Object(F.jsx)("br",{})]}):null,"speed: ",h.speed," m/s"]})]}),Object(F.jsxs)("tr",{children:[Object(F.jsx)("td",{children:"Coordinates:"}),Object(F.jsxs)("td",{children:[f.lat," ",f.lon]})]})]})}),Object(F.jsx)(d.a,{onClick:A,variant:"dark",className:"mb-3",children:"Forecast for 5 days"}),r?Object(F.jsx)(d.a,{variant:"danger",onClick:T,className:"mb-3",children:"Remove from favorite"}):Object(F.jsx)(d.a,{onClick:k,className:"mb-3",children:"Add to favorite"})]}):Object(F.jsx)(H.a,{animation:"grow"})})),$=Object(n.memo)((function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.defaultCity.defaultCity})),c=Object(u.c)((function(e){return e.savedCities.cities})),r=t.sys,s=r.country,a=r.sunrise,i=r.sunset,j=t.main,o=t.wind,b=t.coord,l=t.weather,O=t.name,h=t.id,f=Object(n.useMemo)((function(){return new Date(1e3*a)}),[a]),x=Object(n.useMemo)((function(){return new Date(1e3*i)}),[i]),y=Object(n.useMemo)((function(){return(new Date).toLocaleDateString()}),[]),p=Object(n.useMemo)((function(){return z(f)}),[f]),v=Object(n.useMemo)((function(){return z(x)}),[x]),C=Object(n.useCallback)((function(){return e(g(t))}),[e,t]),R=Object(n.useMemo)((function(){return c.findIndex((function(e){return e.id===h}))>0}),[c,h]),w=Object(n.useCallback)((function(){c.findIndex((function(e){return e.id===h}))>0||e(m(t))}),[c,e,t,h]),_=Object(n.useCallback)((function(e){switch(!0){case e<90:return"North-East";case e>=90&&e<180:return"South-East";case e>=180&&e<270:return"South-West";case e>=270&&e<360:return"North-West";default:return"Checking"}}),[]);return t?Object(F.jsxs)("div",{className:"my-city",children:[Object(F.jsxs)("h2",{children:["Weather in your city: ",O]}),Object(F.jsx)("img",{src:X(l[0].icon),alt:"weather"}),Object(F.jsx)("p",{style:{textAlign:"center"},children:l[0].description}),Object(F.jsxs)("div",{className:"my-city--row my-city--row__name",children:[Object(F.jsx)("span",{children:"t\xb0"}),Object(F.jsx)("span",{children:"Country:"}),Object(F.jsx)("span",{children:"Today is:"}),Object(F.jsx)("span",{children:"Sunrise:"}),Object(F.jsx)("span",{children:"Sunset:"}),Object(F.jsx)("span",{children:"Humidity:"}),Object(F.jsx)("span",{children:"Wind:"}),Object(F.jsx)("span",{children:"Coordinates:"})]}),Object(F.jsxs)("div",{className:"my-city--row my-city--row__details",children:[Object(F.jsxs)("span",{children:[(j.temp-273.15).toFixed(0),"\u2103"]}),Object(F.jsx)("span",{children:s}),Object(F.jsx)("span",{children:y}),Object(F.jsx)("span",{children:p}),Object(F.jsx)("span",{children:v}),Object(F.jsxs)("span",{children:[j.humidity,"%"]}),Object(F.jsxs)("span",{children:[_(o.deg),Object(F.jsx)("br",{}),"speed: ",o.speed," m/s"]}),Object(F.jsxs)("span",{children:[b.lat," ",b.lon]})]}),Object(F.jsx)(d.a,{variant:"dark",className:"mb-3 mt-3",children:"Forecast for 5 days"}),R?Object(F.jsx)(d.a,{variant:"danger",onClick:C,children:"Remove from favorite"}):Object(F.jsx)(d.a,{onClick:w,children:"Add to favorite"})]}):Object(F.jsx)(H.a,{animation:"grow"})})),ee=Object(n.memo)((function(){var e=Object(n.useState)(""),t=Object(a.a)(e,2),c=t[0],r=t[1],s=Object(n.useState)(""),i=Object(a.a)(s,2),j=i[0],o=i[1],d=Object(n.useState)(null),b=Object(a.a)(d,2),h=b[0],f=b[1],x=Object(n.useState)(!1),y=Object(a.a)(x,2),p=y[0],g=y[1],w=Object(u.b)(),_=Object(u.c)((function(e){return e.defaultCity.defaultCity})),E=Object(u.c)((function(e){return e.savedCities.error})),S=Object(u.c)((function(e){return e.savedCities.searchedCity})),T=Object(u.c)((function(e){return e.savedCities.cities})),k=Object(n.useCallback)((function(e){r(e.coords.longitude.toFixed(2)),o(e.coords.latitude.toFixed(2))}),[]);Object(n.useEffect)((function(){navigator.geolocation.getCurrentPosition(k)}),[k]),Object(n.useEffect)((function(){j&&c&&!h&&(w(function(e,t){return function(){var c=Object(O.a)(l.a.mark((function c(n){return l.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return n({type:v}),c.next=3,I.client.get("/weather?lat=".concat(e,"&lon=").concat(t)).then((function(e){var t=e.data;n({type:C,payload:{defaultCity:t}})})).catch((function(e){var t=e.message;n({type:R,payload:{error:t}})}));case 3:case"end":return c.stop()}}),c)})));return function(e){return c.apply(this,arguments)}}()}(j,c)),f(_))}),[h,w,j,c,_]);return Object(F.jsxs)(n.Fragment,{children:[Object(F.jsxs)(D.a,{fluid:!0,children:[Object(F.jsxs)(q.a,{children:[p&&Object(F.jsx)(P.a,{variant:"success",children:"This city has been already added to favorite!"}),E&&Object(F.jsxs)(P.a,{variant:"danger",children:["Request failed with status code 401"===E&&Object(F.jsx)("span",{children:"Bad access key."}),"Request failed with status code 404"===E&&Object(F.jsx)("span",{children:"Error, wrong city code using saved data."}),"Request failed with status code 429"===E&&Object(F.jsx)("span",{children:"You are using free tariff, try again in one minute."})]})]}),_&&Object(F.jsx)(q.a,{children:Object(F.jsx)(M.a,{children:Object(F.jsx)($,{})})})]}),Object(F.jsxs)(D.a,{children:[Object(F.jsx)(q.a,{children:S&&Object(F.jsxs)(M.a,{children:[Object(F.jsx)("h2",{children:"Searched city"}),Object(F.jsx)(Z,{city:S,addToFavorite:function(e){var t=T,c=t.findIndex((function(t){return t.id===e.id}));-1===c?w(m(e)):(t[c]=e,g(!0),setTimeout((function(){g(!1)}),4e3))}})]})}),T.length>0&&Object(F.jsxs)(q.a,{children:[Object(F.jsx)(M.a,{md:12,children:Object(F.jsx)("h2",{children:"Favorite cities"})}),Object(F.jsx)("div",{className:"cities-list",children:T.map((function(e){return Object(F.jsx)(M.a,{md:4,children:Object(F.jsx)(Z,{city:e,canRemove:!0})},e.id)}))})]}),Object(F.jsx)(J,{})]})]})})),te=function(){return Object(F.jsxs)(n.Fragment,{children:[Object(F.jsx)(A,{}),Object(F.jsx)(ee,{})]})},ce=c(42),ne=c(199),re=c(130),se=c(200),ae=c.n(se),ie=c(203),je=c(18),oe={isRequestInProgress:!1,error:!1,cities:[]},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0,c=t.type,n=void 0===c?"":c,r=t.payload,s=void 0===r?{}:r,a=s.searchedCity,i=s.error,j=s.city;s.forecast5city;switch(n){case h:return Object(je.a)(Object(je.a)({},e),{},{error:"",isRequestInProgress:!0});case f:return Object(je.a)(Object(je.a)({},e),{},{searchedCity:a,isRequestInProgress:!1});case x:return Object(je.a)(Object(je.a)({},e),{},{error:i,isRequestInProgress:!1});case y:return Object(je.a)(Object(je.a)({},e),{},{cities:[].concat(Object(ie.a)(e.cities),[j])});case p:return Object(je.a)(Object(je.a)({},e),{},{cities:e.cities.filter((function(e){return e.id!==j.id}))});default:return e}},ue={isRequestInProgress:!1,error:!1,forecast5city:null},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0,c=t.type,n=void 0===c?"":c,r=t.payload,s=void 0===r?{}:r,a=s.error,i=s.forecast5city;switch(n){case w:return Object(je.a)(Object(je.a)({},e),{},{error:"",isRequestInProgress:!0});case _:return Object(je.a)(Object(je.a)({},e),{},{forecast5city:i,isRequestInProgress:!1});case E:return Object(je.a)(Object(je.a)({},e),{},{error:a,isRequestInProgress:!1});default:return e}},le={isRequestInProgress:!1,error:!1,defaultCity:null},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0,c=t.type,n=void 0===c?"":c,r=t.payload,s=void 0===r?{}:r,a=s.defaultCity,i=s.error;switch(n){case v:return Object(je.a)(Object(je.a)({},e),{},{error:"",searchedCity:null,isRequestInProgress:!0});case C:return Object(je.a)(Object(je.a)({},e),{},{defaultCity:a,isRequestInProgress:!1});case R:return Object(je.a)(Object(je.a)({},e),{},{error:i,isRequestInProgress:!1});default:return e}},he=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ce.c,fe={key:"root",storage:ae.a},xe=Object(ce.b)({savedCities:de,defaultCity:Oe,forecastCity:be}),ye=Object(re.a)(fe,xe),pe=Object(ce.d)(ye,he(Object(ce.a)(ne.a))),me=Object(re.b)(pe),ge=c(201);c(374);s.a.render(Object(F.jsx)(u.a,{store:pe,children:Object(F.jsx)(ge.a,{loading:null,persistor:me,children:Object(F.jsx)(te,{})})}),document.getElementById("root"))}},[[375,1,2]]]);
//# sourceMappingURL=main.8e7a43d0.chunk.js.map